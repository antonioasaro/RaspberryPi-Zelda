<!doctype html>
<html>
    <head>
        <title>Project Zelda Poops</title>
        <script type="text/javascript" src="./canvasjs.min.js"></script>
		<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
  	</head>
    <body>
		<h2>Hourly Deposits</h2>
		<div id="canvas" style="height: 300px; width: 100%;"></div>

    <script>
        var randomScalingFactor = function(){ return Math.round(Math.random()*100)};
		var dataX;
	    var dataY;
		var barChart;
        var dataXY = [];

        function initBarChartVar() {
            barChart = new CanvasJS.Chart("canvas", {
                zoomEnabled: true,
                panEnabled: true,
                title: {
                  text: ""
                },
                data: [
                {
                  type: "column",
                  dataPoints: dataXY
                }
                ]
            });
		}

        function drawBarChart() {
			$.get('./zelda.log', function(result) {
				var lines = result.replace(/\n$/g, '').split('\n');
				var date = new Date();
				for (i = 0; i < 1*24; i++) {
                    dataXY[i] = { x: i, y: 0, label: "" };
				}
//				for (i = 0; i < lines.length; i++) {
				for (i = 0; i < 1; i++) {
					year  = Number(lines[i].substr(0,  4));
					month = Number(lines[i].substr(4,  2));
					day   = Number(lines[i].substr(6,  2));
					hour  = Number(lines[i].substr(8,  2));
					min   = Number(lines[i].substr(10, 2));
					sec   = Number(lines[i].substr(12, 2));
					dateX = new Date(year,month,day,hour,min,sec);
					dataXY[i].x = i;
					dataXY[i].label = dateX;

					dataY = lines[i].substr(lines[i].length-4);
					dataXY[i].y = Number(dataY);
				}
			    initBarChartVar();
                barChart.render();
			});
		}

        window.onload = function(){
			drawBarChart();
        }
    </script>
    </body>
	<link rel="stylesheet" type="text/css" href="zelda.css">
</html>
